# <center> DualSpeechLM: Towards Unified Speech Understanding and Generation via Dual Speech Token Modeling with Large Language Models </center>


## Abstract
Extending pre-trained Large Language Models (LLMs)’s speech understanding or generation abilities by introducing various effective speech tokens has attracted great attention in the speech community. However, building a unified speech understanding and generation model still faces the following challenges: (1) Due to the huge modality gap between speech tokens and text tokens, extending text LLMs to unified speech LLMs relies on large-scale paired data for fine-tuning, and (2) Generation and understanding tasks prefer information at different levels, e.g., generation benefits from detailed acoustic features, while understanding favors high-level semantics. This divergence leads to difficult performance optimization in one unified model. To solve these challenges, in this paper, we present two key insights in speech tokenization and speech language modeling. Specifically, we first propose an Understanding-driven Speech Tokenizer (USTokenizer), which extracts high-level semantic information essential for accomplishing understanding tasks using text LLMs. In this way, USToken enjoys better modality commonality with text, which reduces the difficulty of modality alignment in adapting text LLMs to speech LLMs. Secondly, we present DualSpeechLM, a dual-token modeling framework that concurrently models USToken as input and acoustic token as output within a unified, end-to-end framework, seamlessly integrating speech understanding and generation capabilities. Furthermore, we propose a novel semantic supervision loss and a Chain-of-Condition (CoC) strategy to stabilize model training and enhance speech generation performance. Experimental results demonstrate that our proposed approach effectively fosters a complementary relationship between understanding and generation tasks, highlighting the promising strategy of mutually enhancing both tasks in one unified model.

## Model Overview
![DualSpeechLM’s dual-token modeling paradigm. The left illustrates the baseline pipeline treating LLM input/output as identical tokens. In contrast, DualSpeechLM incorporates an Acoustic GPT module into the text LLM module for joint training, separately processing USToken inputs and acoustic token outputs through distinct modeling paths, effectively capturing the different levels of information required for both generation and understanding tasks.](figures/mllm.png) 


## Text-to-Speech (TTS)

| <center> Target Text </center>| <center> Prompt </center> | <center> Baseline-Semantic </center>| <center> Baseline-Acoustic </center>| <center> SpeechGPT </center>| <center> Qwen-TTS </center>| <center> DualSpeechLM-Hubert </center>| <center> DualSpeechLM-USToken(Ours) </center>| <center> Ground Truth </center>|
| ----------------------------------------------------- | ------------------------- | ------------------------- | ------------------------------ | ----------------------------- | ----------------------- | ----------------------- | ----------------------- | ----------------------- |
| Every doctor should provide himself with an antidote case. | <audio src="tts_other/speaker_prompt/1998_15444_000007_000006.wav" controls preload></audio>  | <audio src="tts_other/Baseline-Semantic/1998_15444_000007_000006.wav" controls preload></audio>  | <audio src="tts_other/Baseline-Acoustic/1998_15444_000007_000006.wav" controls preload></audio>  | <audio src="tts_other/speechgpt/1998_15444_000007_000006.wav" controls preload></audio>  | <audio src="tts_other/qwen/1998_15444_000007_000006.wav" controls preload></audio>  | <audio src="tts_other/DualSpeechLM-hubert/1998_15444_000007_000006.wav" controls preload></audio>  | <audio src="tts_other/DualSpeechLM-USToken/1998_15444_000007_000006.wav" controls preload></audio>  | <audio src="tts_other/gt/1998_15444_000007_000006.wav" controls preload></audio>  |
| Remain, I implore you: the evening is most lovely. | <audio src="tts_clean/speaker_prompt/7127_75947_000025_000001.wav" controls preload></audio>  | <audio src="tts_clean/Baseline-Semantic/7127_75947_000025_000001.wav" controls preload></audio>  | <audio src="tts_clean/Baseline-Acoustic/7127_75947_000025_000001.wav" controls preload></audio>  | <audio src="tts_clean/speechgpt/7127_75947_000025_000001.wav" controls preload></audio>  | <audio src="tts_clean/qwen/7127_75947_000025_000001.wav" controls preload></audio>  | <audio src="tts_clean/DualSpeechLM-hubert/7127_75947_000025_000001.wav" controls preload></audio>  | <audio src="tts_clean/DualSpeechLM-USToken/7127_75947_000025_000001.wav" controls preload></audio>  | <audio src="tts_clean/gt/7127_75947_000025_000001.wav" controls preload></audio>  |
| One room is papered, carpeted, over furnished; the next is almost bare. | <audio src="tts_clean/speaker_prompt/237_134493_000022_000001.wav" controls preload></audio>  | <audio src="tts_clean/Baseline-Semantic/237_134493_000022_000001.wav" controls preload></audio>  | <audio src="tts_clean/Baseline-Acoustic/237_134493_000022_000001.wav" controls preload></audio>  | <audio src="tts_clean/speechgpt/237_134493_000022_000001.wav" controls preload></audio>  | <audio src="tts_clean/qwen/237_134493_000022_000001.wav" controls preload></audio>  | <audio src="tts_clean/DualSpeechLM-hubert/237_134493_000022_000001.wav" controls preload></audio>  | <audio src="tts_clean/DualSpeechLM-USToken/237_134493_000022_000001.wav" controls preload></audio>  | <audio src="tts_clean/gt/237_134493_000022_000001.wav" controls preload></audio>  |
| The free State men shrank from forcible resistance to even bogus laws. | <audio src="tts_clean/speaker_prompt/7729_102255_000018_000007.wav" controls preload></audio>  | <audio src="tts_clean/Baseline-Semantic/7729_102255_000018_000007.wav" controls preload></audio>  | <audio src="tts_clean/Baseline-Acoustic/7729_102255_000018_000007.wav" controls preload></audio>  | <audio src="tts_clean/speechgpt/7729_102255_000018_000007.wav" controls preload></audio>  | <audio src="tts_clean/qwen/7729_102255_000018_000007.wav" controls preload></audio>  | <audio src="tts_clean/DualSpeechLM-hubert/7729_102255_000018_000007.wav" controls preload></audio>  | <audio src="tts_clean/DualSpeechLM-USToken/7729_102255_000018_000007.wav" controls preload></audio>  | <audio src="tts_clean/gt/7729_102255_000018_000007.wav" controls preload></audio>  |
| It's my idee as he's braver than the whole Blue Army put together. | <audio src="tts_clean/speaker_prompt/8555_284449_000040_000001.wav" controls preload></audio>  | <audio src="tts_clean/Baseline-Semantic/8555_284449_000040_000001.wav" controls preload></audio>  | <audio src="tts_clean/Baseline-Acoustic/8555_284449_000040_000001.wav" controls preload></audio>  | <audio src="tts_clean/speechgpt/8555_284449_000040_000001.wav" controls preload></audio>  | <audio src="tts_clean/qwen/8555_284449_000040_000001.wav" controls preload></audio>  | <audio src="tts_clean/DualSpeechLM-hubert/8555_284449_000040_000001.wav" controls preload></audio>  | <audio src="tts_clean/DualSpeechLM-USToken/8555_284449_000040_000001.wav" controls preload></audio>  | <audio src="tts_clean/gt/8555_284449_000040_000001.wav" controls preload></audio>  |
| Only under those conditions could the social organization be justified. | <audio src="tts_other/speaker_prompt/4350_9170_000013_000001.wav" controls preload></audio>  | <audio src="tts_other/Baseline-Semantic/4350_9170_000013_000001.wav" controls preload></audio>  | <audio src="tts_other/Baseline-Acoustic/4350_9170_000013_000001.wav" controls preload></audio>  | <audio src="tts_other/speechgpt/4350_9170_000013_000001.wav" controls preload></audio>  | <audio src="tts_other/qwen/4350_9170_000013_000001.wav" controls preload></audio>  | <audio src="tts_other/DualSpeechLM-hubert/4350_9170_000013_000001.wav" controls preload></audio>  | <audio src="tts_other/DualSpeechLM-USToken/4350_9170_000013_000001.wav" controls preload></audio>  | <audio src="tts_other/gt/4350_9170_000013_000001.wav" controls preload></audio>  |
| When Gordon and Jenkins came back, Murdoch tossed the money to them. | <audio src="tts_other/speaker_prompt/8131_117017_000013_000002.wav" controls preload></audio>  | <audio src="tts_other/Baseline-Semantic/8131_117017_000013_000002.wav" controls preload></audio>  | <audio src="tts_other/Baseline-Acoustic/8131_117017_000013_000002.wav" controls preload></audio>  | <audio src="tts_other/speechgpt/8131_117017_000013_000002.wav" controls preload></audio>  | <audio src="tts_other/qwen/8131_117017_000013_000002.wav" controls preload></audio>  | <audio src="tts_other/DualSpeechLM-hubert/8131_117017_000013_000002.wav" controls preload></audio>  | <audio src="tts_other/DualSpeechLM-USToken/8131_117017_000013_000002.wav" controls preload></audio>  | <audio src="tts_other/gt/8131_117017_000013_000002.wav" controls preload></audio>  |



## Voice Conversion (VC) 

| <center> Target Text </center>| <center> Source </center> | <center> Prompt </center> | <center> Baseline-Semantic </center>| <center> Baseline-Acoustic </center>| <center> DualSpeechLM-Hubert </center>| <center> DualSpeechLM-USToken(Ours) </center>| <center> Ground Truth </center>|
| ----------------------------------------------------- | ------------------------- | ------------------------- | ------------------------------ | ----------------------------- | ----------------------- | ----------------------- | ----------------------- |
| The actual primary rainbow observed is said to be the effect of super-imposition of a number of bows. | <audio src="vctk/source/p284_022_p255_022.flac" controls preload></audio>  | <audio src="vctk/prompt/p284_022_p255_022.flac" controls preload></audio>  | <audio src="vctk/Baseline-Semantic/p284_022_p255_022.wav" controls preload></audio>  | <audio src="vctk/Baseline-Acoustic/p284_022_p255_022.wav" controls preload></audio>  | <audio src="vctk/DualSpeechLM-hubert/p284_022_p255_022.wav" controls preload></audio>  | <audio src="vctk/DualSpeechLM-USToken/p284_022_p255_022.wav" controls preload></audio>  | <audio src="vctk/gt/p284_022_p255_022.wav" controls preload></audio>  |
| Throughout the centuries people have explained the rainbow in various ways. | <audio src="vctk/source/p312_012_p247_012.flac" controls preload></audio>  | <audio src="vctk/prompt/p312_012_p247_012.flac" controls preload></audio>  | <audio src="vctk/Baseline-Semantic/p312_012_p247_012.wav" controls preload></audio>  | <audio src="vctk/Baseline-Acoustic/p312_012_p247_012.wav" controls preload></audio>  | <audio src="vctk/DualSpeechLM-hubert/p312_012_p247_012.wav" controls preload></audio>  | <audio src="vctk/DualSpeechLM-USToken/p312_012_p247_012.wav" controls preload></audio>  | <audio src="vctk/gt/p312_012_p247_012.wav" controls preload></audio>  |
| Ask her to bring these things with her from the store. | <audio src="vctk/source/p263_002_p347_002.flac" controls preload></audio>  | <audio src="vctk/prompt/p263_002_p347_002.flac" controls preload></audio>  | <audio src="vctk/Baseline-Semantic/p263_002_p347_002.wav" controls preload></audio>  | <audio src="vctk/Baseline-Acoustic/p263_002_p347_002.wav" controls preload></audio>  | <audio src="vctk/DualSpeechLM-hubert/p263_002_p347_002.wav" controls preload></audio>  | <audio src="vctk/DualSpeechLM-USToken/p263_002_p347_002.wav" controls preload></audio>  | <audio src="vctk/gt/p263_002_p347_002.wav" controls preload></audio>  |
| Others have tried to explain the phenomenon physically. | <audio src="vctk/source/p318_017_p240_017.flac" controls preload></audio>  | <audio src="vctk/prompt/p318_017_p240_017.flac" controls preload></audio>  | <audio src="vctk/Baseline-Semantic/p318_017_p240_017.wav" controls preload></audio>  | <audio src="vctk/Baseline-Acoustic/p318_017_p240_017.wav" controls preload></audio>  | <audio src="vctk/DualSpeechLM-hubert/p318_017_p240_017.wav" controls preload></audio>  | <audio src="vctk/DualSpeechLM-USToken/p318_017_p240_017.wav" controls preload></audio>  | <audio src="vctk/gt/p318_017_p240_017.wav" controls preload></audio>  |
| Charles Gordon, leader of Glasgow City Council declined to comment. | <audio src="vctk/source/p308_328_p240_151.flac" controls preload></audio>  | <audio src="vctk/prompt/p308_328_p240_151.flac" controls preload></audio>  | <audio src="vctk/Baseline-Semantic/p308_328_p240_151.wav" controls preload></audio>  | <audio src="vctk/Baseline-Acoustic/p308_328_p240_151.wav" controls preload></audio>  | <audio src="vctk/DualSpeechLM-hubert/p308_328_p240_151.wav" controls preload></audio>  | <audio src="vctk/DualSpeechLM-USToken/p308_328_p240_151.wav" controls preload></audio>  | <audio src="vctk/gt/p308_328_p240_151.wav" controls preload></audio>  |


## Text-to-Speech Translation (T2ST) 

French-to-English (Fr–En):

| <center> Source Text </center> | <center> DualSpeechLM-USToken(Ours) </center>| <center> Ground Truth </center>|
| ----------------------------------------------------- | ------------------------- | ------------------------- |
| L'Allemand remporte deux autres courses, au Canada et en Allemagne. | <audio src="t2st/fr_en/ours/common_voice_fr_19703806.mp3.wav" controls preload></audio>  | <audio src="t2st/fr_en/gt/common_voice_fr_19703806.mp3.wav" controls preload></audio>  | 
| Il est reconnu pour sa contribution à la mise en valeur de Trois-Rivières. | <audio src="t2st/fr_en/ours/common_voice_fr_19715716.mp3.wav" controls preload></audio>  | <audio src="t2st/fr_en/gt/common_voice_fr_19715716.mp3.wav" controls preload></audio>  | 
| Le groupe des prosimiens est considéré comme un grade par les systématiciens évolutionnistes. | <audio src="t2st/fr_en/ours/common_voice_fr_19736560.mp3.wav" controls preload></audio>  | <audio src="t2st/fr_en/gt/common_voice_fr_19736560.mp3.wav" controls preload></audio>  | 

Spanishto-English (Es–En):

| <center> Source Text </center> | <center> DualSpeechLM-USToken(Ours) </center>| <center> Ground Truth </center>|
| ----------------------------------------------------- | ------------------------- | ------------------------- |
| El idioma oficial del país toma como referencia los dialectos de Funafuti-Vaitupu. | <audio src="t2st/es_en/ours/common_voice_es_19608306.mp3.wav" controls preload></audio>  | <audio src="t2st/es_en/gt/common_voice_es_19608306.mp3.wav" controls preload></audio>  | 
| Su verdadero nombre era Hans Emil Hansen. | <audio src="t2st/es_en/ours/common_voice_es_19667717.mp3.wav" controls preload></audio>  | <audio src="t2st/es_en/gt/common_voice_es_19667717.mp3.wav" controls preload></audio>  | 
| Aquel mismo día cambió su formato tradicional. | <audio src="t2st/es_en/ours/common_voice_es_19604873.mp3.wav" controls preload></audio>  | <audio src="t2st/es_en/gt/common_voice_es_19604873.mp3.wav" controls preload></audio>  | 


## Speech Conversation (SC)

| <center> Speech Content </center>| <center> Question </center> | <center> DualSpeechLM-USToken(Ours) </center>| <center> Ground Truth </center>|
| ----------------------------------------------------- | ------------------------- | ------------------------- | ------------------------------ | 
| <audio src="sc/content/229-130880-0014.flac" controls preload></audio> | <audio src="sc/question/229-130880-0014_question_BV040_streaming.wav" controls preload></audio>  | <audio src="sc/ours/229-130880-0014.wav" controls preload></audio>  | <audio src="sc/gt/229-130880-0014_answer_BV138_streaming.wav" controls preload></audio> | 
| <audio src="sc/content/229-130880-0019.flac" controls preload></audio> | <audio src="sc/question/229-130880-0019_question_BV702_streaming.wav" controls preload></audio>  | <audio src="sc/ours/229-130880-0019.wav" controls preload></audio>  | <audio src="sc/gt/229-130880-0019_answer_BV138_streaming.wav" controls preload></audio> |
| <audio src="sc/content/229-130880-0035.flac" controls preload></audio> | <audio src="sc/question/229-130880-0035_question_BV511_streaming.wav" controls preload></audio>  | <audio src="sc/ours/229-130880-0035.wav" controls preload></audio>  | <audio src="sc/gt/229-130880-0035_answer_BV138_streaming.wav" controls preload></audio> |
| <audio src="sc/content/229-130880-0076.flac" controls preload></audio> | <audio src="sc/question/229-130880-0076_question_BV421_streaming.wav" controls preload></audio>  | <audio src="sc/ours/229-130880-0076.wav" controls preload></audio>  | <audio src="sc/gt/229-130880-0076_answer_BV138_streaming.wav" controls preload></audio> |
| <audio src="sc/content/229-130880-0080.flac" controls preload></audio> | <audio src="sc/question/229-130880-0080_question_BV505_streaming.wav" controls preload></audio>  | <audio src="sc/ours/229-130880-0080.wav" controls preload></audio>  | <audio src="sc/gt/229-130880-0080_answer_BV138_streaming.wav" controls preload></audio> |
